[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Order",
  "enabled": 1,
  "modified": "2021-11-16 09:57:11.087205",
  "name": "Purchase Order-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Purchase Order', {\n\tonload(frm) {\n\t    var t2=frappe.get_list(\"Purchase Order\");\n        console.log(t2);\n        var t3=t2[0].company;\n        console.log(t3);\n        if(t3==\"AVANZA\")\n        {\n            \n            frm.set_value(\"naming_series\",\"PUR-AVZ-.YYYY.-\");\n        }\n        else if(t3==\"SG EDAPPAL\")\n        {\n           frm.set_value(\"naming_series\",\"PUR-SGE-.YYYY.-\");\n        }\n        else if(t3==\"SG KONDOTTY\")\n        {\n           frm.set_value(\"naming_series\",\"PUR-SGKTY-.YYYY.-\");\n        }\n\t\n\t}\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Batch",
  "enabled": 1,
  "modified": "2021-11-17 14:10:21.065093",
  "name": "Batch-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Batch', {\n\tonload(frm) {\n\t   var s1=frappe.defaults.get_user_defaults(\"company\");\n\t   console.log(\"Company\",s1[0]);\n\t   if(s1[0]!=\"AVANZA\")\n\t        {\n\t            \n\t            cur_frm.set_df_property(\"batch_qty\", \"hidden\", true);\n\t       }\n\t\t\n\t}\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Customer",
  "enabled": 1,
  "modified": "2021-10-28 10:30:19.336580",
  "name": "Customer-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Customer', {\n\tonload_post_render: function(frm) {\n         $(\"form>.frappe-control input\").css(\"text-transform\", \"uppercase\");\n \t},\n \tcustomer_name(frm)\n    {\n        var d1=frm.doc.customer_name;\n        console.log(d1);\n        var d2=d1.toUpperCase();\n        frm.set_value(\"customer_name\",d2);\n\n    }\n \t\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Payment Entry",
  "enabled": 1,
  "modified": "2021-10-18 15:21:51.791577",
  "name": "Payment Entry-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Payment Entry', {\n// \trefresh(frm) {\n// \t\t// your code here\n// \t},\n\tonload(frm)\n\t{\n\t   frm.set_value(\"mode_of_payment\",\"Cash\");\n\t   \n\t}\n\t    \n\t    \n\t    \n\t    \n\t\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2021-10-19 17:50:59.123304",
  "name": "Item-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Item', {\n \tonload_post_render: function(frm) {\n         $(\"form>.frappe-control input\").css(\"text-transform\", \"uppercase\");\n \t}\n });",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item Group",
  "enabled": 1,
  "modified": "2021-10-19 17:53:28.381685",
  "name": "Item Group-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Item Group', {\n \tonload_post_render: function(frm) {\n         $(\"form>.frappe-control input\").css(\"text-transform\", \"uppercase\");\n \t}\n });\n\n\n\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Brand",
  "enabled": 1,
  "modified": "2021-10-19 17:55:24.311677",
  "name": "Brand-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Brand', {\n \tonload_post_render: function(frm) {\n         $(\"form>.frappe-control input\").css(\"text-transform\", \"uppercase\");\n \t}\n });",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "UOM",
  "enabled": 1,
  "modified": "2021-10-19 17:55:49.420430",
  "name": "UOM-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('UOM', {\n\t\tonload_post_render: function(frm) {\n         $(\"form>.frappe-control input\").css(\"text-transform\", \"uppercase\");\n \t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Drug Content",
  "enabled": 1,
  "modified": "2021-10-19 17:56:21.200390",
  "name": "Drug Content-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "\nfrappe.ui.form.on('Drug Content', {\n \tonload_post_render: function(frm) {\n         $(\"form>.frappe-control input\").css(\"text-transform\", \"uppercase\");\n \t}\n });",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Prescription Drug Class",
  "enabled": 1,
  "modified": "2021-10-19 17:56:23.373442",
  "name": "Prescription Drug Class-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Prescription Drug Class', {\n\tonload_post_render: function(frm) {\n         $(\"form>.frappe-control input\").css(\"text-transform\", \"uppercase\");\n \t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item Tax Template",
  "enabled": 1,
  "modified": "2021-10-19 17:57:02.482176",
  "name": "Item Tax Template-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Item Tax Template', {\n \tonload_post_render: function(frm) {\n         $(\"form>.frappe-control input\").css(\"text-transform\", \"uppercase\");\n \t}\n });",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Manufacturer",
  "enabled": 1,
  "modified": "2021-10-19 17:57:06.824637",
  "name": "Manufacturer-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "\nfrappe.ui.form.on('Manufacturer', {\n \tonload_post_render: function(frm) {\n         $(\"form>.frappe-control input\").css(\"text-transform\", \"uppercase\");\n \t}\n });",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item Packing Type",
  "enabled": 1,
  "modified": "2021-10-19 17:57:45.697722",
  "name": "Item Packing Type-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Item Packing Type', {\n\tonload_post_render: function(frm) {\n         $(\"form>.frappe-control input\").css(\"text-transform\", \"uppercase\");\n \t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Supplier",
  "enabled": 1,
  "modified": "2021-10-19 18:00:35.173681",
  "name": "Supplier-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Supplier', {\n\t\tonload_post_render: function(frm) {\n         $(\"form>.frappe-control input\").css(\"text-transform\", \"uppercase\");\n \t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Address",
  "enabled": 0,
  "modified": "2021-07-14 12:27:08.273767",
  "name": "Address-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Address', {\n  onload(frm) {\n\t\tcheck_customer(frm);\n\t},refresh(frm) {\n\t\tcheck_customer(frm);\n\t},\n  validate(frm){\n    check_customer(frm);\n  }\n\n});\n\nvar check_customer = function(frm){\n  $.each(frm.doc.links || [], function(i, v) {\n    console.log(\"test1\");\n    frappe.call({\n         method: 'frappe.client.get',\n         args: {\n             'doctype': 'Customer',\n             'filters': {'name': v.link_name}\n         },\n         callback: function(r){\n            if(r.message.customer_type == \"Business\"){\n              frm.set_df_property('tax_category', 'reqd', 1);\n              frm.set_df_property('gstin', 'reqd', 1);\n              frm.set_df_property('gst_state', 'reqd', 1);\n              frm.set_df_property('gst_state_number', 'reqd', 1);\n              frm.refresh_field('tax_category');\n              frm.refresh_field('gstin');\n              frm.refresh_field('gst_state_number');\n              frm.refresh_field('gst_state');\n            }\n         }\n    });\n  });\n};\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item Price",
  "enabled": 1,
  "modified": "2021-11-11 11:39:12.723657",
  "name": "Item Price-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Item Price',\n{\n    onload(frm)\n    {\n        \n        var e=frappe.defaults.get_user_defaults(\"Company\");\n        console.log(e[0]);\n        \n       if(e[0]==\"AVANZA\")\n       {\n       \n             if(frm.doc.price_list !==undefined)\n            {\n                cur_frm.set_df_property(\"price_list_2\", \"hidden\", true);\n                cur_frm.set_df_property(\"price_list_3\", \"hidden\", true);\n                cur_frm.set_df_property(\"rate_for_price_list_2\", \"hidden\", true);\n                cur_frm.set_df_property(\"rate_for_price_list_3\", \"hidden\", true);\n             }\n            else\n            {\n             frm.set_value(\"price_list\",\"Company Buying\"); \n             \n             \n            }  \n       }\n       else \n       {   \n                    \n                    if(frm.doc.price_list_rate===undefined && frm.doc.rate_for_price_list_3===undefined)\n                    {\n                        frm.set_value(\"price_list\",\"Price To Franchaisee - (PTF)\")\n                        cur_frm.set_df_property(\"price_list_2\", \"hidden\", true); \n                        cur_frm.set_df_property(\"rate_for_price_list_2\", \"hidden\", true);\n                    }\n                    else\n                    {\n                        \n                        if(frm.doc.price_list==\"Price To Franchaisee - (PTF)\")\n                        {\n                            \n                           cur_frm.set_df_property(\"price_list_2\", \"hidden\", true); \n                           cur_frm.set_df_property(\"rate_for_price_list_2\", \"hidden\", true);\n                           cur_frm.set_df_property(\"price_list_3\", \"hidden\", true); \n                           cur_frm.set_df_property(\"rate_for_price_list_3\", \"hidden\", true);\n                        }\n                        else\n                        {\n                            cur_frm.set_df_property(\"price_list_2\", \"hidden\", true); \n                            cur_frm.set_df_property(\"rate_for_price_list_2\", \"hidden\", true);\n                            cur_frm.set_df_property(\"price_list_3\", \"hidden\", true); \n                            cur_frm.set_df_property(\"rate_for_price_list_3\", \"hidden\", true);\n                            \n                        }\n                        \n                    }\n               \n       \n       }\n       \n        \n      \n        \n       \n    },\n    \n    batch_no(frm)\n    {\n      console.log(frm.doc.batch_no);\n      if(frm.doc.batch_no !==undefined)\n      {\n        frappe.call\n        ({\n          \"method\":\"frappe.client.get_list\",\n          \"args\":\n          {\n              \"doctype\":\"Item Price\",\n              \"filters\":{\"item_code\":cur_frm.doc.item_code,\"batch_no\":cur_frm.doc.batch_no},\n              \"fields\":[\"price_list\"]\n          },\n          callback:function(r)\n          {\n              if(r)\n              {\n                  console.log(cur_frm.doc.item_code);\n                  console.log(cur_frm.doc.batch_no);\n                  console.log(r);\n                  if(r.message.length !==0)\n                  {\n                      msgprint(\"Already exist price list of \"+ cur_frm.doc.item_code +\" in batch  \"+ cur_frm.doc.batch_no);\n                  }\n                  \n              }\n          }\n            \n        });   \n      }\n     \n    },\n    \n\tvalidate(frm) \n\t{\n\t    if(!frm.doc.item_code || !frm.doc.batch_no|| !frm.doc.price_list_rate ||  !frm.doc.rate_for_price_list_3)\n\t    {\n\t        frappe.throw(\"Please fill mandatory fields..\");\n            frappe.validated = false;\n\t    }\n\t    else\n\t    {\n\t       frappe.call\n        ({\n          \"method\":\"frappe.client.get_list\",\n          \"args\":\n            {\n              \"doctype\":\"Item Price\",\n              \"filters\":{\"item_code\":cur_frm.doc.item_code,\"batch_no\":cur_frm.doc.batch_no},\n              \"fields\":[\"price_list\"]\n            },\n            callback:function(r)\n            {\n                 if(r)\n                 {\n                    console.log(cur_frm.doc.item_code);\n                    console.log(cur_frm.doc.batch_no);\n                    console.log(r.message.length);\n                    if(r.message.length !==0)\n                    {\n                      msgprint(\"Already exist price list of \"+ cur_frm.doc.item_code +\" in batch  \"+ cur_frm.doc.batch_no);\n                      validated=false;\n                      return false;\n                    } \n                    else\n                    { \n                      if(frm.doc.price_list!==\"\")\n\t\t              {\n\t\t                if(frm.doc.price_list_3==\"Price To Customer - (PTC)\")\n\t\t                {\n\t\t                     msgprint(\"Price List 1 Added Successfully\");\n\t\t                }\n\t\t             }  \n                \t if(frm.doc.price_list_2!==\"\")\n\t            \t {\n\t\t                if(frm.doc.price_list_2==\"Price To Franchaisee - (PTF)\")\n\t\t                     {\n\t\t                        msgprint(\"Price List 2 Added Successfully\");\n\t\t                     }\n\t\t              }\n\t            \t  if(frm.doc.price_list_3!==\"\")\n\t\t              {\n\t\t                if(frm.doc.price_list_3==\"Price To Customer - (PTC)\")\n\t\t                {\n\t\t                     msgprint(\"Price List 3 Added Successfully\");\n\t\t                }\n\t\t               }  \n                    }\n                 }\n            }\n        });  \n\t    }\n\t    \n\t   \n\t},\n\t\n    after_save(frm) \n    {  \n        \n    \n    \n        \n        // var pp=frappe.get_list(\"Item Price\");\n        // console.log('kkkkkkkkkkkkkkkkkkkkkk');\n        // console.log('999999999999999=============',pp);\n        // console.log('itemcode ====',pp[0].item_code);\n        // console.log('pricelist====',pp[0].price_list);\n        // console.log('pricelist Rate====',pp[0].price_list_rate);\n        // console.log('pricelist2===',pp[0].price_list_2);\n        // console.log('pricelist3===',pp[0].price_list_3);\n        // console.log('pricelist Rate 2===',pp[0].rate_for_price_list_2);\n        // console.log('pricelist Rate 3===',pp[0].rate_for_price_list_3);\n        // var R2=pp[0].rate_for_price_list_2;\n        // var R3=pp[0].rate_for_price_list_3;\n        \n        var e=frappe.defaults.get_user_defaults(\"Company\");\n        if(e[0]==\"AVANZA\")\n        {\n                frappe.db.insert\n                ({\n                    doctype:'Item Price',\n                    item_code:frm.doc.item_code,\n                    price_list:\"Price To Franchaisee - (PTF)\",\n                    price_list_rate:frm.doc.rate_for_price_list_2,\n                    rate_for_price_list_2:0,\n                    rate_for_price_list_3:0,\n                    batch_no:frm.doc.batch_no\n                })\n         \n                .then(function(doc)\n                { \n            console.log(`${doc.doctype} ${doc.name} created on ${doc.creation}`);\n         });\n                frappe.db.insert\n                ({\n            doctype:'Item Price',\n            item_code:frm.doc.item_code,\n            //item_code:pp[0].item_code,\n            price_list:\"Price To Customer - (PTC)\",\n            price_list_rate:frm.doc.rate_for_price_list_3,\n            rate_for_price_list_2:0,\n            rate_for_price_list_3:0,\n            batch_no:frm.doc.batch_no,\n           // batch_no:pp[0].batch_no\n          })\n                .then(function(doc)\n                { \n              console.log(`${doc.doctype} ${doc.name} created on ${doc.creation}`);\n            });\n        } \n        else\n        {\n          frappe.db.insert\n          ({\n            doctype:'Item Price',\n            item_code:frm.doc.item_code,\n            price_list:\"Price To Customer - (PTC)\",\n            price_list_rate:frm.doc.rate_for_price_list_3,\n            rate_for_price_list_2:0,\n            rate_for_price_list_3:0,\n            batch_no:frm.doc.batch_no\n          })\n          .then(function(doc)\n           { \n              console.log(`${doc.doctype} ${doc.name} created on ${doc.creation}`);\n            });  \n        }\n       \n    }\n       \n});\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Sales Invoice",
  "enabled": 1,
  "modified": "2021-11-12 12:16:19.862044",
  "name": "Sales Invoice-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "//Code Added by Efeone\nfrappe.ui.form.on('Sales Invoice Item', {\n\tposa_is_offer:function(frm,cdt,cdn){\n        var d=locals[cdt][cdn];\n        if(d.posa_is_offer==1){\n            frappe.model.set_value(cdt,cdn,\"rate\",0);\n        }\n\t}\n});\n\n//Code Added by Webeaz\n\n// var r;\n// var i;\n// frappe.ui.form.on('Sales Invoice Item', {\n// \trate: function(frm, cdt,cdn) {\n// \t\tvar d = locals[cdt][cdn];\n// \t\tr=d.rate;\n// \t\tfrm.trigger('selling_price_list');\n// \t},\n//     item_code:function(frm,cdt,cdn)\n//     {\n//         var d3=locals[cdt][cdn];\n//         var r=d3.item_code;\n//         var d=locals[cdt][cdn];\n//         var pp=d.default_mrp\n//         var w3=d.default_strip_conversion_factor\n//         var tyr=pp/w3\n//         frappe.model.set_value(cdt,cdn,\"mrp\",tyr)  //Already setting by fetchfrom\n//         frappe.call({\n//             \"method\":\"frappe.client.get\",\n//             \"args\":{\n//                 \"doctype\":\"Item\",\n//                 \"filters\":{\"item_code\":r},\n               \n//             },\n//             callback:function(u)\n//             {\n//                  if(u)\n//                  {\n//                      var d13=u.message.uoms\n//                      var lastElement = d13[d13.length - 1];\n//                      frappe.model.set_value(cdt,cdn,\"default_strip_conversion_factor\",lastElement.conversion_factor)\n//                  }\n//             }\n//         });\n//     },\n// \tposa_is_offer:function(frm,cdt,cdn){\n//         var d=locals[cdt][cdn];\n//         if(d.posa_is_offer==1){\n//             frappe.model.set_value(cdt,cdn,\"rate\",0);\n//         }\n//         if(d.posa_is_offer===0){\n//             frappe.model.set_value(cdt,cdn,\"rate\",r);\n//         }\n// \t}\n//  });",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Receipt",
  "enabled": 1,
  "modified": "2021-11-11 11:40:05.752670",
  "name": "Purchase Receipt-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Purchase Receipt',\n{\n\trefresh(frm) {\n\t\t// your code here\n\t}\n});\n\nvar tt;\nvar ii;\nvar bb;\nfrappe.ui.form.on(\"Purchase Receipt Item\",\n{\n    rate:function(frm,cdt,cdn)\n    {\n        var d2=locals[cdt][cdn];\n        if(d2.rate>0)\n        {\n            tt=d2.rate;\n            console.log(tt);\n        }\n    },\n    free:function(frm,cdt,cdn)\n    {\n        var d=locals[cdt][cdn];\n        if(d.free==1)\n        {\n            frappe.model.set_value(cdt,cdn,\"rate\",0);\n        }\n        if(d.free===0)\n        {\n            frappe.model.set_value(cdt,cdn,\"rate\",tt);\n        }\n    },\n    discount:function(frm,cdt,cdn)\n    {\n        var d1=locals[cdt][cdn];\n        if(d1.discount>0)\n        {\n            console.log(\"Discount Entered\");\n            var result=d1.rate-d1.rate*d1.discount/100;\n            frappe.model.set_value(cdt,cdn,\"rate\",result);\n        }\n    },\n    item_code:function(frm,cdt,cdn)\n    {\n        var d3=locals[cdt][cdn];\n        console.log(d3.item_code);\n        ii=d3.item_code;\n        if(d3.item_code.charAt(0)==\"E\")\n        {\n            var p1=[];\n            console.log(\"External Item Added\",ii);\n            frappe.call({\n                \"method\" : \"frappe.client.get_list\",\n                \"args\" :\n                {\n                    \"doctype\" : \"Item\",\n                    \"filters\" : {\"item_code\":ii},\n                    \"fields\"  :[\"drug_content\"] \n                },\n                callback:function(r)\n                {\n                    if(r)\n                    {\n                        console.log(r);\n                        p1=r.message[0].drug_content;\n                        console.log(\"r1r1r1r1r1rr\",p1);\n                        frappe.call\n                        ({\n                            \"method\":\"frappe.client.get_list\",\n                            \"args\":\n                            {\n                                \"doctype\":\"Item\",\n                                \"filters\":{\"drug_content\":p1,\"purchase_type\":\"Internal\"},\n                                \"fields\":[\"item_name\"]\n                            },\n                            callback:function(r1)\n                            {\n                                console.log(\"Internal Item\",r1);\n                                var neww=r1.message;\n                                var neww2=[];\n                                for( var i=0;i<neww.length;i++)\n                                {\n                                    console.log(neww[i].item_name);\n                                    var neww1=neww[i].item_name;\n                                    neww2.push(neww1);\n                                }\n                                console.log(\"weeeeeeeeeeeeeeeeeeeeeeeee\",neww2);\n                                frappe.msgprint({\n                                    title:__('Notification'),\n                                    indicator:'green',\n                                    message:__(\"You have similar Product in Storegenrix:\"+neww2)\n                                });\n                            }\n                        });\n                    }\n                }\n            });\n        }\n    },\n    batch_no:function(frm,cdt,cdn)\n    {\n        var d6=locals[cdt][cdn];\n        \n        msgprint(\"heloooo..\");\n         var child = locals[cdt][cdt].items; \n      // grid_row = cur_frm.fields_dict.items.grid.grid_rows_by_docname[\"new-purchase-receipt-1\"];\n       \n      // field = frappe.utils.filter_dict(grid_row.docfields, {fieldname: \"batch_no\"});\n\n        console.log(child);\n        console.log(\"batch    \"+d6.batch_no);\n        bb=d6.batch_no;\n        frappe.call\n        ({\n            \"method\":\"frappe.client.get_list\",\n            \"args\":\n            {\n                \"doctype\":\"Item Price\",\n                \"filters\":{\"item_code\":ii,\"batch_no\":bb},\n                \"fields\":[\"price_list\",\"price_list_rate\"]\n            },\n            callback:function(r)\n            {\n                if(r)\n                {\n                    if(r.message.length===0)\n                    {\n                        frappe.model.set_value(cdt,cdn,\"company_buying_rate\",\"None\");\n                        frappe.model.set_value(cdt,cdn,\"price_to_franchise_rate\",\"None\");\n                        frappe.model.set_value(cdt,cdn,\"price_to_customer_rate\",\"None\");\n                    }\n                    console.log(\"baatches item pricee\",r);\n                    for(var i=0;i<r.message.length;i++)\n                    {\n                        if(r.message[i].price_list==\"Company Buying\")\n                        {\n                            frappe.model.set_value(cdt,cdn,\"company_buying_rate\",r.message[i].price_list_rate);\n                        }\n                        if(r.message[i].price_list==\"Price To Franchaisee - (PTF)\")\n                        {\n                            frappe.model.set_value(cdt,cdn,\"price_to_franchise_rate\",r.message[i].price_list_rate);\n                        }\n                        if(r.message[i].price_list==\"Price To Customer - (PTC)\")\n                        {\n                            frappe.model.set_value(cdt,cdn,\"price_to_customer_rate\",r.message[i].price_list_rate);\n                        }\n                    }\n                }\n            }\n        });\n    },\n    set_prices:function(frm,cdt,cdn)\n    {\n        var d7=locals[cdt][cdn];\n        \n       // console.log(\"Set Priceeeeeeeeeees\");\n        //console.log(d7);\n       // console.log(\"kkkk\"+d7.item_code);\n       // console.log(d7.batch_no);\n        let d5=new frappe.ui.Dialog\n        ({\n            title:\"Set Prices\",\n            fields:\n            [\n                {\n                   label:\"Item Code\",\n                   fieldname:'item',\n                   fieldtype:'Data',\n                },\n                {\n                   label:\"Company Buying Rate\",\n                   fieldname:'c_b_r',\n                   fieldtype:'Data',\n                },\n                {\n                   label:\"Price to Franchise(PTF)\",\n                   fieldname:'ptf',\n                   fieldtype:'Data',\n                },\n                {\n                   label:\"Price to Customer(PTC)\",\n                   fieldname:'ptc',\n                   fieldtype:'Data',\n                },\n                {\n                   label:\"Batch Name\",\n                   fieldname:'batch',\n                   fieldtype:'Data',\n                },\n                ],\n                primary_action_label:\"Add Prices\",\n                primary_action(values)\n                {\n                    console.log(values),\n                    // ii=values.item;\n                    // bb=values.batch;\n                    \n                    \n                    frappe.db.insert\n                    ({\n                        doctype:'Item Price',\n                        item_code:d7.item_code,\n                        price_list:\"Company Buying\",\n                        price_list_rate:values.c_b_r,\n                        batch_no:d7.batch_no\n                    });\n                    frappe.db.insert\n                    ({\n                        doctype:'Item Price',\n                        item_code:d7.item_code,\n                        price_list:\"Price To Franchaisee - (PTF)\",\n                        price_list_rate:values.ptf,\n                        batch_no:d7.batch_no\n                    });\n                    frappe.db.insert({\n                        doctype:'Item Price',\n                        item_code:d7.item_code,\n                        price_list:\"Price To Customer - (PTC)\",\n                        price_list_rate:values.ptc,\n                        batch_no:d7.batch_no\n                    });\n                    msgprint(\"Prices added successfully\");\n                    d5.hide();\n                }\n        });\n        d5.show();\n        d5.fields_dict.item.set_value(d7.item_code);\n        d5.fields_dict.item.refresh();\n        d5.fields_dict.batch.set_value(d7.batch_no);\n        d5.fields_dict.batch.refresh();\n    }\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Invoice",
  "enabled": 0,
  "modified": "2021-10-28 14:35:40.693653",
  "name": "Purchase Invoice-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Purchase Invoice', {\n\tonload(frm){\n\t\tvar batches=[];;\n        var dates=[];\n        if(frm.doc.supplier && frm.doc.company && frm.doc.supplier!==\"Internal Supplier SG\"){\n            frappe.call({\n                \"method\":\"frappe.client.get\",\n                \"args\":{\n                    \"doctype\":\"Purchase Receipt\",\n                    \"filters\":{\"company\":frm.doc.company,\"supplier\":frm.doc.supplier}\n                },\n                callback:function(r){\n                    if(r){\n                        console.log(r);\n                        console.log(r.message.items);\n                        var j=0;\n                        $.each(r.message.items, function(i, item) {\n                            console.log(\"egfegerf\");\n                            console.log(j);\n                            batches[j] = item.batch_no;\n                            dates[j]=item.batch_expiry_date;\n                            j=j+1;\n                            console.log(item.batch_no);\n                        });\n                        var j=0;\n                        console.log(batches);\n                        $.each(frm.doc.items, function(i, item) {\n                            item.batch_no=batches[j];\n                            item.expiry_date=dates[j];\n                            j=j+1;\n                        });\n                        frm.refresh_field(\"items\");\n                        frm.refresh();\n                    \n                    }\n                    else{\n                        return false;\n                    }\n                }\n            });\n        }\n        else{\n            console.log(\"Intercompany Purchase Invoice\");\n            frm.set_value(\"update_stock\",false);\n        }\n\t}\n});",
  "view": "Form"
 }
]